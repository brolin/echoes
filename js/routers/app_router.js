define(["jquery","underscore","backbone"],function(e,t,n){var r=n.Router.extend({routes:{"":"explore",explore:"explore","access_token=:token&token_type=:tokenType&expires_in=:expires":"connect","filter/:feedType":"filter","playlist/:playlistId":"showPlaylistInfo","searches/:query":"search","play/video/:mediaId":"playVideoItem","play/playlist/:playlistId/:index":"playPlaylistItem"},initialize:function(e){this.model=e.model,this.model.on("change:currentIndex",this.updatePlaylistUrl,this),this.model.start(),n.history.start()},explore:function(){this.markNav("explore")},history:function(){},connect:function(e,t,n){this.model.connect(e)},search:function(e){this.model.set({query:e},{silent:!0})},filter:function(e){this.model.set("filter",e),this.model.set("layout",e)},showPlaylistInfo:function(e){this.model.youtube().set({showPlaylistId:e}),this.model.route("playlistInfo")},playMedia:function(e,t){this.model.playMedia(t,{type:e})},playVideoItem:function(e){this.model.playMedia({type:"video",mediaId:e})},playPlaylistItem:function(e,t){this.model.playMedia({type:"playlist",mediaId:e,index:t})},updatePlaylistUrl:function(e,n){var r=this.model.get("play")||"";t.isNumber(n)&&r!==""&&this.navigate("play/playlist/"+r+"/"+n,{trigger:!1})},markNav:function(t){e("#library-nav").find("li").removeClass("active").end().find("a[href^='#"+t+"']").parent().addClass("active")}});return r});