define(["jquery","underscore","backbone","modules/gsignin/gsignin"],function(e,t,n,i){var s=Backbone.View.extend({el:"#user-profile",events:{"click .sign-out":"signOut","click .action":function(e){e.preventDefault(),this.model.updates.check()}},initialize:function(){this.listenTo(this.model.youtube.profile,"change:items",this.renderUsername),this.signinButton=new i({el:this.$(".sign-in")[0],scopes:this.model.user.auth.scopes,clientId:this.model.user.getClientId()}),this.listenTo(this.signinButton,"auth:success",this.handleSignIn),this.faceId=setInterval(this.refershFacebookPage.bind(this),144e5),this.connect()},connect:function(){this.model.youtube.profile.connect()},handleSignIn:function(){this.connect()},renderUsername:function(){var e=this.model.youtube.profile,t="",n="Username",i=!1;e&&e.attributes.items&&(t="url("+e.picture("high")+")",n=e.title(),i=!0),this.$(".icon-user").css("backgroundImage",t),this.$(".username").html(n),this.$el.toggleClass("user-signed-in",i)},signOut:function(e){e.preventDefault(),this.disconnectUser()},disconnectUser:function(){var t=this,n="https://accounts.google.com/o/oauth2/revoke?token="+gapi.auth.getToken().access_token;e.ajax({type:"GET",url:n,async:!1,contentType:"application/json",dataType:"jsonp",success:function(){t.model.youtube.profile.clear()},error:function(){}})},refershFacebookPage:function(){var e=this.$(".facebook-page"),t=e.html();e.html(t)}});return{create:function(e){return new s({model:e})}}});