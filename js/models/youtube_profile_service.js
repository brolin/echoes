define(["underscore","backbone","vars","collections/youtube_playlists_provider","./youtube/ProfileService","models/youtube/gplusAuth"],function(t,e,n,i,s,r){var o=e.Model.extend({playlists:new i,auth:new r,profile:new s,initialize:function(){this.on("change:token",this.fetchProfile,this)},onProfileChange:function(t){this.playlists.username=t.getUsername(),this.playlists.fetch()},cred:{clientId:"971861197531.apps.googleusercontent.com",clientSecret:"t7KrdesISXI-4ViBJ5jZOXSt",token:""},signinUrl:function(){return["https://accounts.google.com/o/oauth2/auth?","client_id="+this.cred.clientId+"&","redirect_uri="+n.youtube.redirect_uri+"&","scope=https://gdata.youtube.com&","response_type=token"].join("")},refreshToken:function(){return["https://accounts.google.com/o/oauth2/token?","client_id="+this.cred.clientId+"&","client_secret="+this.cred.clientSecret+"&","refresh_token="+this.get("token")+"&","grant_type=refresh_token"].join("")},signin:function(){return this.signinUrl()},fetchProfile:function(t,e){this.cred.token=e,this.url=this.profile(),this.url&&this.fetch()},setToken:function(t){this.set("token",t)},parse:function(t){t&&this.set(t.entry)},getUsername:function(){return this.get("yt$username")?this.get("yt$username").$t:""},getDisplayUsername:function(){return this.get("yt$username")?this.get("yt$username").display:"Username"},getThumbnail:function(){return this.get("media$thumbnail")?this.get("media$thumbnail").url:""},signOut:function(){this.auth.signOut()},getClientId:function(){return this.auth.clientId()}});return o});