define(["jquery","underscore","backbone"],function(t,e,i){var n="AIzaSyCgrK5ds9uCSRM-WBUFm8V8jPX66q8-Od0",s={apiKey:n,client_id:"971861197531",scopes:"https://www.googleapis.com/auth/youtube"},r=i.Model.extend({clientId:function(){return s.client_id},defaults:{q:"eric clapton",part:"snippet",maxResults:24},methods:{list:{},update:{},insert:{},"delete":{}},connect:function(){return window.gapi&&gapi.client&&gapi.client.setApiKey?this.auth():(window.onGapiLoad=e.bind(this.onGapiLoad,this),require(["https://apis.google.com/js/client.js?onload=onGapiLoad"],function(){}),this)},onGapiLoad:function(){this.trigger("load:gapi"),gapi.client.setApiKey(n),this.auth()},immediate:!0,auth:function(){gapi.auth.authorize({client_id:s.client_id,scope:this.scopes,immediate:this.immediate},e.bind(this.handleAuthResult,this))},handleAuthResult:function(t){if(t&&!t.error){var s=function(){this.trigger("load:client"),i.trigger("gapiload:youtube")};gapi.client.setApiKey(n),gapi.client.load(this.client.api,this.client.version,e.bind(s,this)),this.trigger("auth:success",t)}},url:function(){return gapi.client.youtube.search},sync:function(){return i.GapiSync.apply(this,arguments)},fetch:function(t){return this.sync("read",this,t)},create:function(t){return this.sync("create",this,t)},"delete":function(t){return this.sync("delete",this,t)},update:function(t){return this.sync("update",this,t)}});i.GapiSync=function(t,i,n){function s(){o.execute(n.success),i.trigger("request",i,o,n),i.off("auth:success",s)}var r=e.result(this,"url"),c=u[t],o=r[c](this.methods[c]);n=n||{};var h=n.success;return n.success=function(t){return t.error?(i.trigger("req:error",i,t,n),t.error):i.set(i.parse(t,n),n)?(h&&h(i,t,n),void i.trigger("sync",i,t,n)):!1},a[t]?(this.off("auth:success",s),this.on("auth:success",s,this),this.auth()):s(),o};var u={create:"insert",update:"update","delete":"delete",read:"list"},a={create:!0,update:!0,"delete":!0};return r});