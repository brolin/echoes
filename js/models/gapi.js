define(["jquery","underscore","backbone"],function(t,e,i){var s="AIzaSyCgrK5ds9uCSRM-WBUFm8V8jPX66q8-Od0",n={apiKey:s,client_id:"971861197531",scopes:"https://www.googleapis.com/auth/youtube"},a=i.Model.extend({clientId:function(){return n.client_id},defaults:{q:"eric clapton",part:"snippet",maxResults:24},methods:{list:{},update:{},insert:{},"delete":{}},connect:function(){return window.gapi&&gapi.client&&gapi.client.setApiKey?this.auth():(window.onGapiLoad=e.bind(this.onGapiLoad,this),require(["https://apis.google.com/js/client.js?onload=onGapiLoad"],function(){}),this)},onGapiLoad:function(){this.trigger("load:gapi"),gapi.client.setApiKey(s),this.auth()},immediate:!0,auth:function(){gapi.auth.authorize({client_id:n.client_id,scope:this.scopes,immediate:this.immediate},e.bind(this.handleAuthResult,this))},handleAuthResult:function(t){if(t&&!t.error){var n=function(){this.trigger("load:client"),i.trigger("gapiload:youtube")};gapi.client.setApiKey(s),gapi.client.load(this.client.api,this.client.version,e.bind(n,this)),this.trigger("auth:success",t)}},url:function(){return gapi.client.youtube.search},sync:function(){return i.GapiSync.apply(this,arguments)},fetch:function(t){this.sync("read",this,t)},create:function(t){this.sync("create",this,t)},update:function(t){this.sync("update",this,t)}});i.GapiSync=function(t,i,s){function n(){o.execute(s.success),i.trigger("request",i,o,s),i.off("auth:success",n)}var a=e.result(this,"url"),u=r[t],o=a[u](this.methods[u]);s=s||{};var h=s.success;return s.success=function(t){return t.error?(i.trigger("req:error",i,t,s),t.error):i.set(i.parse(t,s),s)?(h&&h(i,t,s),void i.trigger("sync",i,t,s)):!1},c[t]?(this.off("auth:success",n),this.on("auth:success",n,this),this.auth()):n(),o};var r={create:"insert",update:"update","delete":"delete",read:"list"},c={create:!0,update:!0,"delete":!0};return a});