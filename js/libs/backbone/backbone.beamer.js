define(["underscore","backbonesrc"],function(){var e=this._,t=this.Backbone;if(e&&t&&JSON){var i={View:{},Model:{},Collection:{},Router:{}},n=function(t,n){return function(o){var s=o.initialize||this.prototype.initialize||function(){};return o.initialize=function(){e.each(i[n],function(t,i){this[i]&&(e.extend(this,new t.extension(this)),t.initialize&&t.initialize.apply(this))},this),s.apply(this,arguments)},t.call(this,o)}},o={View:!1,Model:!1,Collection:!1,Router:!1},s=function(i){this._type=i,t.on("extend:"+i,e.bind(this.register,this))};s.prototype={register:function(e){this.config=e,this.ensureExtend(),this.validate()&&(i[this._type][e.key]=e)},ensureExtend:function(){o[this._type]||(o[this._type]=!0,t[this._type].extend=n(t[this._type].extend,this._type))},validate:function(){return i[this._type][this.config.key]&&console.log("An extension with the same key:",extConfig.key,"is already exsiting or has already been loaded."),!i[this._type][this.config.key]}};var h=["View","Model","Collection","Router"],a=function(e){new s(e)};e.each(h,a)}});