(function(){function n(e){this.cv_views=[],this.$target=e.view.target?e.$(e.view.target):e.$el;if(e.collection)return;this._sourceRender=e.render||function(){},e.view&&e.view.collection?this.collection=new e.view.collection:this.collection=new t.Collection}var e=this._,t=this.Backbone;if(!e||!t||!JSON)return;n.prototype={render:function(){this.resetViews(),this.cv_views=this.collection.map(this.createItem,this),this.$target.append(e.map(this.cv_views,this.prepareItem,this)),this.trigger("view-after:render")},createItem:function(e){var t=this.view.type;return new t({model:e})},prepareItem:function(t,n){return e.each(this.view.events,function(e,n){this.listenTo(t,n,this[e])},this),t.render().el},_listenToLastestView:function(e,t){this.cv_views[this._currentViewIndex]&&this.listenTo(this.cv_views[this._currentViewIndex],t,this[e])},renderItem:function(t){var n=this.cv_views.length,r=this.view.type;this.cv_views.push(this.createItem(t)),this.$target.append(this.prepareItem(e.last(this.cv_views),n))},addItems:function(t){var n=e.map(t,this.createItem,this);return this.$target.append(e.map(n,this.prepareItem,this)),this},resetViews:function(){e.each(this.cv_views,function(e){this.stopListening(e)},this),e.invoke(this.cv_views,"remove"),this.cv_views.length=0},_hide:function(){this.$el.removeClass(this.transition.css)},_show:function(){this.$el.addClass(this.transition.css)}};var r=function(){t.trigger("extend:View",{key:"view",extension:n,initialize:function(){this.listenTo(this.collection,"reset destroy remove sort",function(){this.render()}),this.listenTo(this.collection,"add",function(e){this.renderItem(e)})}})};r(),t.on("xManager:ready",r)})();