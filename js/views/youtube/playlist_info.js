define(["jquery","underscore","backbone","text!templates/youtube_playlist_provider_item.html"],function(e,t,n,r){var i=n.View.extend({template:t.template(r),initialize:function(){this.playerModel=this.model.get("player"),this.listenTo(this.model.youtube().get("playlist"),"change:items",this.render),this.listenTo(this.playerModel,"change:index",this.updateIndex),this.listenTo(this.model.youtube().get("info"),"change:id",this.ensureSelectedIndex)},render:function(e,n){if(!n)return;this.playlistId=e.get("id"),this.currentIndex=this.playerModel.get("index");var r=t.map(n,this.makeListItem,this);this.$el.html(r.join(""))},makeListItem:function(e,t){if(!e)return;return this.template({id:e.video.id,title:e.video.title,index:t,position:e.position,playlistId:this.playlistId,current:t===this.currentIndex?"active":""})},updateIndex:function(e,t){this.currentIndex=t,this.$(".active").removeClass("active").end().find(".track-"+t).addClass("active")},ensureSelectedIndex:function(e){this.$(".active").removeClass("active"),this.$(".playlist-provider-item[data-videoid="+e.id+"]").addClass("active")}});return i});